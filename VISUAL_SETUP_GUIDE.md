# Visual Setup Guide ğŸ¨

Quick visual reference for setting up database and Google OAuth.

---

## ğŸ“Š Database Setup (Choose One Path)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DATABASE OPTIONS                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                             â”‚
       Local PostgreSQL              Hosted Service
            â”‚                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                â”‚        â”‚                     â”‚
brew install    Docker   Vercel  Supabase  Neon  Railway
postgresql               Postgres
    â”‚                â”‚        â”‚         â”‚      â”‚      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                   Get DATABASE_URL
                           â”‚
                   Add to .env.local
                           â”‚
                npx prisma migrate dev
                           â”‚
                      âœ… READY
```

---

## ğŸ” Google OAuth Flow

### Step 1: Google Cloud Console
```
https://console.cloud.google.com
         â”‚
    Create Project
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                             â”‚
Enable APIs              Configure OAuth
    â”‚                             â”‚
âœ“ Google+ API           1. Consent Screen
âœ“ Drive API                  â”‚
âœ“ Docs API                   â”œâ”€ App name
âœ“ Sheets API                 â”œâ”€ Support email
âœ“ Slides API                 â””â”€ Add scopes
    â”‚                             â”‚
    â”‚                        2. Create Credentials
    â”‚                             â”‚
    â”‚                        OAuth Client ID
    â”‚                             â”‚
    â”‚                        Web Application
    â”‚                             â”‚
    â”‚                   Add Redirect URIs
    â”‚                             â”‚
    â”‚              http://localhost:3000/
    â”‚              api/auth/callback/google
    â”‚                             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         Get Client ID & Secret
                  â”‚
          Add to .env.local
                  â”‚
             Test Sign In
                  â”‚
             âœ… READY
```

---

## ğŸ—‚ï¸ File Structure After Setup

```
trade-study-agent/
â”œâ”€â”€ .env.local              â† YOUR API KEYS (gitignored)
â”‚   â”œâ”€â”€ NEXTAUTH_SECRET     âœ“ Auto-generated
â”‚   â”œâ”€â”€ NEXTAUTH_URL        âœ“ http://localhost:3000
â”‚   â”œâ”€â”€ GOOGLE_CLIENT_ID    âš ï¸ Add from Google Console
â”‚   â”œâ”€â”€ GOOGLE_CLIENT_SECRETâš ï¸ Add from Google Console
â”‚   â”œâ”€â”€ DATABASE_URL        âš ï¸ Add from PostgreSQL/Provider
â”‚   â””â”€â”€ OPENAI_API_KEY      âš ï¸ Add from OpenAI Platform
â”‚
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma       âœ“ Already configured
â”‚   â””â”€â”€ migrations/         âœ“ Created by migrate dev
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ auth.ts             âœ“ Uses GOOGLE_CLIENT_ID/SECRET
â”‚   â”œâ”€â”€ db.ts               âœ“ Uses DATABASE_URL
â”‚   â””â”€â”€ openai.ts           âœ“ Uses OPENAI_API_KEY
â”‚
â””â”€â”€ Documentation
    â”œâ”€â”€ DATABASE_OAUTH_SETUP.md   â† Detailed setup guide
    â”œâ”€â”€ QUICK_REFERENCE.md        â† Commands & tips
    â””â”€â”€ AGENT_SETUP.md            â† Full documentation
```

---

## ğŸ¯ Environment Variables Checklist

### Required for Basic Functionality
```env
âœ… NEXTAUTH_URL="http://localhost:3000"
âœ… NEXTAUTH_SECRET="[generated by openssl]"
```

### Required for Google Sign-In
```env
âš ï¸ GOOGLE_CLIENT_ID="123456.apps.googleusercontent.com"
âš ï¸ GOOGLE_CLIENT_SECRET="GOCSPX-abc123..."
```

### Required for AI Agent
```env
âš ï¸ OPENAI_API_KEY="sk-proj-abc123..."
```

### Required for Data Persistence
```env
âš ï¸ DATABASE_URL="postgresql://user:pass@host:5432/db"
```
*Can skip for demo - app falls back to in-memory data*

### Optional (for Google Publishing)
```env
â­• GOOGLE_SERVICE_ACCOUNT_KEY="{...}"
â­• GOOGLE_DRIVE_FOLDER_ID="abc123..."
```

---

## ğŸ”„ OAuth Sign-In Flow

```
User clicks "Sign in with Google"
         â”‚
         â†“
    /api/auth/signin/google
         â”‚
         â†“
Redirect to Google
         â”‚
User approves permissions:
  â€¢ Email
  â€¢ Profile
  â€¢ Drive (optional)
  â€¢ Docs (optional)
  â€¢ Sheets (optional)
         â”‚
         â†“
Google redirects back to:
/api/auth/callback/google
         â”‚
         â†“
NextAuth verifies response
         â”‚
         â†“
Creates/updates records:
  â€¢ User table (name, email)
  â€¢ Account table (tokens)
  â€¢ Session table (session token)
         â”‚
         â†“
Sets session cookie
         â”‚
         â†“
Redirects to /dashboard
         â”‚
         â†“
    âœ… User signed in!
```

---

## ğŸ—„ï¸ Database Schema Overview

```sql
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NextAuth Tables                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ User                                                     â”‚
â”‚  â€¢ id, name, email, emailVerified, image                â”‚
â”‚  â€¢ createdAt, updatedAt                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Account (stores OAuth tokens)                           â”‚
â”‚  â€¢ id, userId, provider, providerAccountId              â”‚
â”‚  â€¢ refresh_token, access_token, expires_at              â”‚
â”‚  â€¢ scope, id_token, token_type                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Session                                                  â”‚
â”‚  â€¢ id, sessionToken, userId, expires                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ VerificationToken                                        â”‚
â”‚  â€¢ identifier, token, expires                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Trade Study Tables                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TradeStudy                                              â”‚
â”‚  â€¢ id, title, summary, status                           â”‚
â”‚  â€¢ data (JSON - agent updates this!)                    â”‚
â”‚  â€¢ ownerId â†’ User                                       â”‚
â”‚  â€¢ createdAt, updatedAt                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TradeStudyMember                                        â”‚
â”‚  â€¢ id, role (owner/collaborator/viewer)                 â”‚
â”‚  â€¢ userId â†’ User                                        â”‚
â”‚  â€¢ tradeStudyId â†’ TradeStudy                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TradeStudyAttachment                                    â”‚
â”‚  â€¢ id, type (doc/sheet/slide/drive)                     â”‚
â”‚  â€¢ fileId, title                                        â”‚
â”‚  â€¢ tradeStudyId â†’ TradeStudy                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§ª Testing Checklist

After setup, test in this order:

### 1. Database Connection
```bash
npx prisma studio
# Should open browser showing tables
```

### 2. Server Start
```bash
npm run dev
# Should see: ready - started server on 0.0.0.0:3000
```

### 3. Basic Pages
- âœ… http://localhost:3000 (home)
- âœ… http://localhost:3000/login (login page)

### 4. Google OAuth
- âœ… Click "Sign in with Google"
- âœ… See Google permission screen
- âœ… Grant permissions
- âœ… Redirect to /dashboard
- âœ… See your name in header

### 5. Database Verification
```bash
npx prisma studio
# Check User table â†’ your account
# Check Account table â†’ Google OAuth tokens
# Check Session table â†’ active session
```

### 6. Create Trade Study
- âœ… Dashboard â†’ "New Study"
- âœ… Fill form â†’ Save
- âœ… See in database (Prisma Studio â†’ TradeStudy table)

### 7. Run Agent
- âœ… Open trade study
- âœ… Scroll to "AI Agent" card
- âœ… Select "Analyze" â†’ "Run Agent"
- âœ… See execution steps
- âœ… See AI analysis
- âœ… Page refreshes with updated data

---

## ğŸ“ Common Setup Paths

### Path A: Local Development (Simplest)
```
âœ… Local PostgreSQL
âœ… Google OAuth (test users only)
âœ… OpenAI API key
â­• Skip Google service account
```

### Path B: Vercel Deployment (Recommended)
```
âœ… Vercel Postgres (built-in)
âœ… Google OAuth (production)
âœ… OpenAI API key
â­• Optional: Google service account
```

### Path C: Full Production
```
âœ… Hosted PostgreSQL (Supabase/Neon)
âœ… Google OAuth (published app)
âœ… OpenAI API key
âœ… Google service account (for publishing)
âœ… Custom domain
```

---

## ğŸ†˜ Quick Troubleshooting

| Symptom | Fix |
|---------|-----|
| Can't connect to DB | Check `DATABASE_URL`, restart PostgreSQL |
| OAuth redirect error | Add redirect URI to Google Console |
| "Unauthorized" error | Sign in with Google first |
| "OPENAI_API_KEY not set" | Add key to `.env.local`, restart server |
| Tables don't exist | Run `npx prisma migrate dev` |
| Changes not reflecting | Restart dev server (Ctrl+C, `npm run dev`) |

---

## ğŸ“ Learning Resources

### Google Cloud Console
- **Dashboard**: https://console.cloud.google.com
- **API Library**: Search for "Google Drive API", etc.
- **Credentials**: APIs & Services â†’ Credentials

### Get API Keys
- **OpenAI**: https://platform.openai.com/api-keys
- **Google OAuth**: Google Cloud Console â†’ Credentials
- **Database**: Provider dashboard (Vercel/Supabase/Neon)

### Documentation
- **Detailed Setup**: [DATABASE_OAUTH_SETUP.md](./DATABASE_OAUTH_SETUP.md)
- **Commands**: [QUICK_REFERENCE.md](./QUICK_REFERENCE.md)
- **Agent Guide**: [AGENT_SETUP.md](./AGENT_SETUP.md)

---

## âœ¨ Success Indicators

You're fully set up when:

1. âœ… `npm run dev` starts without errors
2. âœ… Can sign in with Google
3. âœ… Prisma Studio shows your user
4. âœ… Can create trade studies
5. âœ… Agent runs and returns analysis
6. âœ… No environment variable warnings

**Congratulations!** ğŸ‰ You're ready to build.
